import{_ as a,p as n,q as s,a1 as t}from"./framework-d81ad7e5.js";const p={},e=t(`<ul><li><p>https://blog.csdn.net/gisarmory/article/details/109672301</p></li><li><p><strong>leaflet如何加载10万条数据</strong></p></li></ul><h3 id="canvas渲染方式" tabindex="-1"><a class="header-anchor" href="#canvas渲染方式" aria-hidden="true">#</a> canvas渲染方式</h3><p>leaflet支持两种渲染方式，svg 和 canvas，默认是svg渲染，这样可以兼容低版本的IE浏览器。canvas渲染需要IE9+，或谷歌、火狐的高版本浏览器。<strong>canvas比svg性能好</strong></p><ul><li>在初始化地图时，设置map的 preferCanvas 属性为 true，代码如下：</li></ul><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token string">&#39;map&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">39.905963</span><span class="token punctuation">,</span> <span class="token number">116.390813</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>    
    <span class="token literal-property property">preferCanvas</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><ul><li>这个设置只针对继承了Path类的矢量图层有效，包括圆点（CircleMarker）、线（Polyline）、面（Polygon）、圆（Circle）、矩形（Rectangle）。针对图片标记（Marker）没有作用。</li><li>借助插件 Leaflet.Canvas-Markers，提升Marker的显示性能。插件git地址：<code>https://github.com/eJuke/Leaflet.Canvas-Markers</code></li><li>Leaflet.Canvas-Markers 插件 Leaflet.Canvas-Markers 插件提供了一个 L.canvasIconLayer 类，这个类是一个图层，将 Marker 添加到这个图层中时，这个图层会以 canvas 方式渲染 Marker 中的图片。</li></ul><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 创建图层，添加到 map</span>
<span class="token keyword">var</span> ciLayer <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">canvasIconLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义 Marker</span>
<span class="token keyword">var</span> marker <span class="token operator">=</span>  <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">marker</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">58.5578</span><span class="token punctuation">,</span> <span class="token number">29.0087</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">icon</span><span class="token operator">:</span> icon<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 把 Marker 添加到图层</span>
ciLayer<span class="token punctuation">.</span><span class="token function">addMarker</span><span class="token punctuation">(</span>marker<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><ul><li><p>问题，就是地图缩放时，添加的数据不跟着同步缩放，而是等到缩放完成后，再去缩放。这样感觉缩放时，数据在飘着。</p></li><li><p><code>https://github.com/eJuke/Leaflet.Canvas-Markers/pull/21</code></p><ul><li>leaflet支持两种渲染方式，svg 和 canvas，canvas的显示性能要明显优于svg。</li><li>IE9之前版本浏览器不支持canvas方式渲染。</li><li>默认是svg方式渲染，要手动切换成canvas方式。</li><li>渲染方式设置成canvas后，加载矢量图形性能会提升，加载图片标记的效率仍然低。</li><li>通过Leaflet.Canvas-Markers插件来提升图片标记的显示效率。</li><li>Leaflet.Canvas-Markers插件在缩放地图时有bug，需要在github上找已经解决此bug的版本。</li></ul></li></ul>`,8),o=[e];function c(l,r){return n(),s("div",null,o)}const i=a(p,[["render",c],["__file","leaflet_big.html.vue"]]);export{i as default};
