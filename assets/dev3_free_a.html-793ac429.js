import{_ as n,p as a,q as s,a1 as t}from"./framework-d81ad7e5.js";const p={},e=t(`<h2 id="freemarker-导出word" tabindex="-1"><a class="header-anchor" href="#freemarker-导出word" aria-hidden="true">#</a> freemarker 导出word</h2><h3 id="xml分页" tabindex="-1"><a class="header-anchor" href="#xml分页" aria-hidden="true">#</a> xml分页</h3><ul><li>分页符是需要依附于某个元素的</li></ul><div class="language-xml" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- 下标为偶数时执行分页 --&gt;</span>
   &lt;#if per_index?if_exists+1%2 ==0&gt; 
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>p</span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>br</span> <span class="token attr-name"><span class="token namespace">w:</span>type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>p</span><span class="token punctuation">&gt;</span></span> 
   <span class="token comment">&lt;!-- 此标签用于强制分页 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#if</span><span class="token punctuation">&gt;</span></span>
    

<span class="token comment">&lt;!-- 分页符 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>p</span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>br</span> <span class="token attr-name"><span class="token namespace">w:</span>type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>p</span><span class="token punctuation">&gt;</span></span> 
</code></pre></div><ul><li><code>另存为word 2003 xml格式的xml,然后xmll文件改后缀，xxx.xml-&gt;xxx.ftl</code></li><li>正文在w:body 标签下</li><li>取出参数<code>\${world}</code> 其中\${},是占位符，world是属性名</li><li>表格</li><li><code>w:tab 是表格标签，w:tr是row tr 用&lt;#list&gt; &lt;w:tr&gt; &lt;/w:tr&gt; &lt;/#list&gt; 标签循环 </code></li><li>页边距：<code>&lt;w:pgMar w:top=&quot;2275&quot; w:right=&quot;1800&quot; w:bottom=&quot;1699&quot; w:left=&quot;1800&quot; w:header=&quot;851&quot; w:footer=&quot;992&quot; w:gutter=&quot;0&quot;/&gt;</code></li></ul><h3 id="xml-文档结构" tabindex="-1"><a class="header-anchor" href="#xml-文档结构" aria-hidden="true">#</a> xml 文档结构</h3><div class="language-xml" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>wordDocument</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>p</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>pPr</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>pPr</span><span class="token punctuation">&gt;</span></span>    
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>rPr</span><span class="token punctuation">&gt;</span></span>属性：加粗，倾斜，字体颜色等<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>rPr</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>t</span><span class="token punctuation">&gt;</span></span> 文本内容<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>t</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span>      
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>body</span><span class="token punctuation">&gt;</span></span>
&lt;/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>wordDocument</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 判断null --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#if</span> <span class="token attr-name">users?exists</span> <span class="token attr-name">&amp;&amp;</span> <span class="token attr-name">users.size</span> <span class="token attr-name">!</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span> 0</span> <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">users</span> <span class="token attr-name">as</span> <span class="token attr-name">u</span><span class="token punctuation">&gt;</span></span>
                    <span class="token comment">&lt;!-- 表格 --&gt;</span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>tbl</span><span class="token punctuation">&gt;</span></span>
                    <span class="token comment">&lt;!-- 每一行 --&gt;</span>
                     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>tr</span><span class="token punctuation">&gt;</span></span>
                     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>tr</span><span class="token punctuation">&gt;</span></span> 
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>tbl</span><span class="token punctuation">&gt;</span></span>
                    
                    <span class="token comment">&lt;!-- 每10个分页 --&gt;</span>
                &lt;#if u.id%10 == 0 &gt; 
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>p</span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>br</span> <span class="token attr-name"><span class="token namespace">w:</span>type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>p</span><span class="token punctuation">&gt;</span></span> 
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#if</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li><p><code>&lt;w:p&gt;</code> 会包裹一段数据，（段落）</p></li><li><p><code>&lt;w:pPr&gt;</code> 段落的属性，可选元素。 段落属性的一些示例包括对齐方式、边框、断字覆盖、缩进、行距、底纹、文本方向和孤行控制</p></li><li><p><code>&lt;w:r&gt;</code> 它是具有一组共同属性（如格式设置）的文本区域。它可以包含多个<code>&lt;w:t&gt;</code>元素。</p></li><li><p>如果示例文本中只有一个字是粗体，粗体将会分离到一个<code>&lt;w:r&gt;</code>中</p></li><li><p><code>&lt;w:rPr&gt;</code>用于指定<code>&lt;w:r&gt;</code>属性。 连续文本属性的一些示例包括粗体、边框、字符样式、颜色、字体、字号、斜体、字距调整、禁用拼写/语法检查、底纹、小号大写字母、删除线、文字方向和下划线</p></li><li><p><code>&lt;w:t&gt;</code> 实际的文本内容</p></li></ul><ul><li><strong>注意： 分页是标签要包裹 &lt;w:tbl&gt;</strong></li><li>每一页都是新的 table</li><li>表头 可以用 if 标签来控制</li></ul><div class="language-xml" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- 双重List 动态生成page --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">pvc</span> <span class="token attr-name">as</span> <span class="token attr-name">brw</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#list</span> <span class="token attr-name">brw</span> <span class="token attr-name">as</span> <span class="token attr-name">basic</span><span class="token punctuation">&gt;</span></span>
                <span class="token comment">&lt;!-- 分页全部包裹 --&gt;</span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>tbl</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>tr</span><span class="token punctuation">&gt;</span></span>
                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>tr</span><span class="token punctuation">&gt;</span></span>
                       
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>tbl</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#if</span>  <span class="token attr-name">brw_has_next</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>p</span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>br</span> <span class="token attr-name"><span class="token namespace">w:</span>type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>p</span><span class="token punctuation">&gt;</span></span> 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#if</span><span class="token punctuation">&gt;</span></span>
                        
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#list</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 最后一页 不分页 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>#if</span>  <span class="token attr-name">!showLimit</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>p</span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">w:</span>br</span> <span class="token attr-name"><span class="token namespace">w:</span>type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">w:</span>p</span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>#if</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h3 id="java-render" tabindex="-1"><a class="header-anchor" href="#java-render" aria-hidden="true">#</a> java Render</h3><div class="language-java" data-ext="java"><pre class="language-java"><code>
	<span class="token annotation punctuation">@Autowired</span>
	<span class="token class-name">FreeMarkerConfigurer</span> freeMarkerConfigurer<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">Template</span> <span class="token function">getTemplate</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> freeMarkerConfigurer<span class="token punctuation">.</span><span class="token function">getConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
	 * 
	 * @Title: exportDocToClient   
	 * @Description: TODO(这里用一句话描述这个方法的作用)   
	 * <span class="token keyword">@param</span>: @param response  响应流
	 * <span class="token keyword">@param</span>: @param fileName	导出文件名
	 * <span class="token keyword">@param</span>: @param tplName	模板名称  
	 * 	spring boot /src/main/resources/templates
	 * <span class="token keyword">@param</span>: @param data      Map<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>String,</span> <span class="token attr-name">Object</span><span class="token punctuation">&gt;</span></span> data 数据
	 * <span class="token keyword">@param</span>: @throws <span class="token reference"><span class="token class-name">Exception</span></span>      
	 * <span class="token keyword">@return</span>: void      
	 * <span class="token keyword">@throws</span>
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exportDocToClient</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">String</span> fileName<span class="token punctuation">,</span> <span class="token class-name">String</span> tplName<span class="token punctuation">,</span>
			<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> data<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
		response<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/msword&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//	        response.setContentType(&quot;application/msexcel&quot;);</span>
		response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Disposition&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attachment;filename=&quot;</span> <span class="token operator">+</span> <span class="token class-name">URLEncoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 把本地文件发送给客户端</span>
		<span class="token class-name">Writer</span> writer <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Template</span> template <span class="token operator">=</span> <span class="token function">getTemplate</span><span class="token punctuation">(</span>tplName<span class="token punctuation">)</span><span class="token punctuation">;</span>
		template<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">;</span>
		writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>



</code></pre></div>`,12),o=[e];function c(l,u){return a(),s("div",null,o)}const i=n(p,[["render",c],["__file","dev3_free_a.html.vue"]]);export{i as default};
