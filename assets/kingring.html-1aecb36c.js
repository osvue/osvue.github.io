import{_ as n,p as s,q as a,a1 as t}from"./framework-d81ad7e5.js";const p={},o=t(`<h3 id="克里金插值" tabindex="-1"><a class="header-anchor" href="#克里金插值" aria-hidden="true">#</a> 克里金插值</h3><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code>组件库简介
kriging<span class="token punctuation">.</span>js是一个开源的克里金插值算法组件库，核心方法如下：

<span class="token comment">// 使用gaussian、exponential或spherical模型对数据集进行训练，返回的是一个variogram对象；</span>
kriging<span class="token punctuation">.</span><span class="token function">train</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> model<span class="token punctuation">,</span> sigma2<span class="token punctuation">,</span> alpha<span class="token punctuation">)</span>
<span class="token comment">// 使用variogram对象使polygons范围描述的地理位置内的格网元素具备不一样的预测值,width是插值格点精度大小</span>
kriging<span class="token punctuation">.</span><span class="token function">grid</span><span class="token punctuation">(</span>polygons<span class="token punctuation">,</span>variogram<span class="token punctuation">,</span>width<span class="token punctuation">)</span>
<span class="token comment">// 将得到的格网grid渲染至canvas上。</span>
kriging<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span>grid<span class="token punctuation">,</span>xlim<span class="token punctuation">,</span>ylim<span class="token punctuation">,</span>colors<span class="token punctuation">)</span><span class="token operator">:</span> 
<span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>sakitam<span class="token operator">-</span>gis<span class="token operator">/</span>kriging<span class="token punctuation">.</span>js

kriging<span class="token operator">-</span><span class="token function">contour组件库是一个基于克里金插值算法，根据离散点位置及其权重，生成等值面矢量数据</span><span class="token punctuation">(</span>GeoJSON格式<span class="token punctuation">)</span><span class="token function">和栅格数据</span><span class="token punctuation">(</span>Canvas绘制图片<span class="token punctuation">)</span>，这些数据在任何WebGIS客户端上都可通用展示。

<span class="token literal-property property">https</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>FreeGIS<span class="token operator">/</span>kriging<span class="token operator">-</span>contour

安装依赖库
# 安装克里金插值所需的插件
npm i @turf<span class="token operator">/</span>turf
# 方法一
npm i @sakitam<span class="token operator">-</span>gis<span class="token operator">/</span>kriging
# 方法二
npm i kriging<span class="token operator">-</span>contour

# 引入kriging<span class="token punctuation">.</span>js
<span class="token keyword">import</span> kriging <span class="token keyword">from</span> <span class="token string">&#39;@sakitam-gis/kriging&#39;</span><span class="token punctuation">;</span>
# 引入kriging<span class="token operator">-</span>contour
<span class="token keyword">import</span> <span class="token punctuation">{</span> getVectorContour<span class="token punctuation">,</span> drawCanvasContour <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;kriging-contour/dist/kriging-contour.js&#39;</span>
</code></pre></div><h3 id="实现思路" tabindex="-1"><a class="header-anchor" href="#实现思路" aria-hidden="true">#</a> 实现思路</h3><p>首先划定一个区域利用turfJS随机一部分数据(也可使用真实点状数据集)，然后插件渲染空间插值至canvas或生成面状geojson，然后添加到地图容器中进行展示。</p><h3 id="turf生成随机数据" tabindex="-1"><a class="header-anchor" href="#turf生成随机数据" aria-hidden="true">#</a> turf生成随机数据</h3><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 随机点的边界(折线的最大包围盒坐标)</span>
<span class="token keyword">const</span> boundaries <span class="token operator">=</span> turf<span class="token punctuation">.</span><span class="token function">lineString</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">118</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 随机50个点状要素数据</span>
<span class="token keyword">let</span> positionData <span class="token operator">=</span> turf<span class="token punctuation">.</span><span class="token function">randomPoint</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">bbox</span><span class="token operator">:</span> turf<span class="token punctuation">.</span><span class="token function">bbox</span><span class="token punctuation">(</span>boundaries<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 再生成些随机数做属性</span>
turf<span class="token punctuation">.</span><span class="token function">featureEach</span><span class="token punctuation">(</span>positionData<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">currentFeature<span class="token punctuation">,</span> featureIndex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    currentFeature<span class="token punctuation">.</span>properties <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="方法一-kriging库插值" tabindex="-1"><a class="header-anchor" href="#方法一-kriging库插值" aria-hidden="true">#</a> 方法一：kriging库插值</h3><p>使用体验：在大量数据进行插值时，处理速度较慢；色带颜色如果较少，格网间颜色差异较大；插值的范围要按照特定的格式填入，否则无法加载。</p><div class="language-vue" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app-contain<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- leaflet 地图容器 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>canvasMap<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myMap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>controls<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#626aef<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>startKriging(&#39;kriging&#39;)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>普通克里金<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#626aef<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>startKriging(&#39;Vector&#39;)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>克里金矢量<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#626aef<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>startKriging(&#39;Image&#39;)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>克里金图像<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#626aef<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clearKriging()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>清空<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// 引入样式</span>
<span class="token keyword">import</span> <span class="token constant">L</span> <span class="token keyword">from</span> <span class="token string">&#39;leaflet&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&#39;leaflet/dist/leaflet.css&#39;</span>
<span class="token comment">// 引入turf</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> turf <span class="token keyword">from</span> <span class="token string">&#39;@turf/turf&#39;</span>
<span class="token comment">// 引入kriging.js</span>
<span class="token keyword">import</span> kriging <span class="token keyword">from</span> <span class="token string">&#39;@sakitam-gis/kriging&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// 引入kriging-contour</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getVectorContour<span class="token punctuation">,</span> drawCanvasContour <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;kriging-contour/dist/kriging-contour.js&#39;</span>
<span class="token comment">// VUE组件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token comment">// 天地图TK</span>
<span class="token keyword">let</span> tdtKey <span class="token operator">=</span> <span class="token string">&#39;YOURS_TK&#39;</span>
<span class="token keyword">let</span> map <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> featureLayerGroup <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> imageLayerGroup <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">initMap</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 矢量地图</span>
  <span class="token keyword">const</span> tiandituMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>TileLayer</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">http://t0.tianditu.gov.cn/cva_c/wmts?layer=cva&amp;style=default&amp;tilematrixset=c&amp;Service=WMTS&amp;Request=GetTile&amp;Version=1.0.0&amp;Format=tiles&amp;TileMatrix={z}&amp;TileCol={x}&amp;TileRow={y}&amp;tk=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>tdtKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">tileSize</span><span class="token operator">:</span> <span class="token number">512</span><span class="token punctuation">,</span>
      <span class="token literal-property property">noWrap</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">bounds</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 文字注记</span>
  <span class="token keyword">const</span> tiandituText <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>TileLayer</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">http://t0.tianditu.com/vec_c/wmts?layer=vec&amp;style=default&amp;tilematrixset=c&amp;Service=WMTS&amp;Request=GetTile&amp;Version=1.0.0&amp;Format=tiles&amp;TileMatrix={z}&amp;TileCol={x}&amp;TileRow={y}&amp;tk=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>tdtKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">tileSize</span><span class="token operator">:</span> <span class="token number">512</span><span class="token punctuation">,</span>
      <span class="token literal-property property">noWrap</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">bounds</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> layers <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">layerGroup</span><span class="token punctuation">(</span><span class="token punctuation">[</span>tiandituText<span class="token punctuation">,</span> tiandituMap<span class="token punctuation">]</span><span class="token punctuation">)</span>
  map <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token string">&#39;myMap&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  <span class="token comment">//需绑定地图容器div的id</span>
    <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">39.56</span><span class="token punctuation">,</span> <span class="token number">116.20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//初始地图中心</span>
    <span class="token literal-property property">crs</span><span class="token operator">:</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token constant">CRS</span><span class="token punctuation">.</span><span class="token constant">EPSG4326</span><span class="token punctuation">,</span>
    <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">//初始缩放等级</span>
    <span class="token literal-property property">maxZoom</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token comment">//最大缩放等级</span>
    <span class="token literal-property property">minZoom</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//最小缩放等级</span>
    <span class="token literal-property property">zoomControl</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//缩放组件</span>
    <span class="token literal-property property">attributionControl</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//去掉右下角logol</span>
    <span class="token literal-property property">scrollWheelZoom</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//默认开启鼠标滚轮缩放</span>
    <span class="token comment">// 限制显示地理范围</span>
    <span class="token literal-property property">maxBounds</span><span class="token operator">:</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">latLngBounds</span><span class="token punctuation">(</span><span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">latLng</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">latLng</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">layers</span><span class="token operator">:</span> <span class="token punctuation">[</span>layers<span class="token punctuation">]</span> <span class="token comment">// 图层</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 矢量图层组</span>
  featureLayerGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>FeatureGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bringToFront</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 图像图层组</span>
  imageLayerGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">L<span class="token punctuation">.</span>FeatureGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bringToFront</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">startKriging</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">krigingType</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 随机点的边界(折线的最大包围盒坐标)</span>
  <span class="token keyword">const</span> boundaries <span class="token operator">=</span> turf<span class="token punctuation">.</span><span class="token function">lineString</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">118</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 随机50个点状要素数据</span>
  <span class="token keyword">let</span> positionData <span class="token operator">=</span> turf<span class="token punctuation">.</span><span class="token function">randomPoint</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">bbox</span><span class="token operator">:</span> turf<span class="token punctuation">.</span><span class="token function">bbox</span><span class="token punctuation">(</span>boundaries<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 再生成些随机数做属性</span>
  turf<span class="token punctuation">.</span><span class="token function">featureEach</span><span class="token punctuation">(</span>positionData<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">currentFeature<span class="token punctuation">,</span> featureIndex</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    currentFeature<span class="token punctuation">.</span>properties <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;Vector&#39;</span> <span class="token operator">==</span> krigingType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showKrigingVector</span><span class="token punctuation">(</span>boundaries<span class="token punctuation">,</span> positionData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;Image&#39;</span> <span class="token operator">==</span> krigingType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showKrigingImage</span><span class="token punctuation">(</span>boundaries<span class="token punctuation">,</span> positionData<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;kriging&#39;</span> <span class="token operator">==</span> krigingType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showKriging</span><span class="token punctuation">(</span>boundaries<span class="token punctuation">,</span> positionData<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">showKriging</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">boundaries<span class="token punctuation">,</span> positionData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 清空图层</span>
  <span class="token function">clearKriging</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 完全透明</span>
  <span class="token keyword">let</span> scope <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">geoJSON</span><span class="token punctuation">(</span>boundaries<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">style</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">fillColor</span><span class="token operator">:</span> <span class="token string">&#39;6666ff&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&#39;red&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fillOpacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>imageLayerGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>

  map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//根据scope边界线，生成范围信息</span>
  <span class="token keyword">let</span> xlim <span class="token operator">=</span> <span class="token punctuation">[</span>scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_southWest<span class="token punctuation">.</span>lng<span class="token punctuation">,</span> scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_northEast<span class="token punctuation">.</span>lng<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> ylim <span class="token operator">=</span> <span class="token punctuation">[</span>scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_southWest<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_northEast<span class="token punctuation">.</span>lat<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">loadkriging</span><span class="token punctuation">(</span><span class="token parameter">points</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;canvasMap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token comment">// 数量</span>
    <span class="token keyword">let</span> pointLength <span class="token operator">=</span> points<span class="token punctuation">.</span>features<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 数值</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 经度</span>
    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 纬度</span>
    <span class="token comment">// 加载点数过多的话，会出现卡顿</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pointLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      x<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>points<span class="token punctuation">.</span>features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      y<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>points<span class="token punctuation">.</span>features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      t<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>points<span class="token punctuation">.</span>features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 将插值点展示到地图中,并添加提示文字(可删除，非核心代码)</span>
      <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">circle</span><span class="token punctuation">(</span><span class="token punctuation">[</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>imageLayerGroup<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">bindTooltip</span><span class="token punctuation">(</span>points<span class="token punctuation">.</span>features<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>properties<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">permanent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是永久打开还是悬停打开</span>
          <span class="token literal-property property">direction</span><span class="token operator">:</span> <span class="token string">&#39;top&#39;</span> <span class="token comment">//方向</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openTooltip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 克里金插值参数</span>
    <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">krigingModel</span><span class="token operator">:</span> <span class="token string">&#39;exponential&#39;</span><span class="token punctuation">,</span><span class="token comment">//model还可选&#39;gaussian&#39;,&#39;spherical&#39;</span>
      <span class="token literal-property property">krigingSigma2</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">krigingAlpha</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      <span class="token literal-property property">canvasAlpha</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span><span class="token comment">//canvas图层透明度-0.75</span>
      <span class="token literal-property property">colors</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;#00A600&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#01A600&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#03A700&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#04A700&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#05A800&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#07A800&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#08A900&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#09A900&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#0BAA00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#0CAA00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#0DAB00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#0FAB00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#10AC00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#12AC00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#13AD00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#14AD00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#16AE00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#17AE00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#19AF00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#1AAF00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#1CB000&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#1DB000&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#1FB100&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#20B100&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#22B200&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#23B200&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#25B300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#26B300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#28B400&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#29B400&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#2BB500&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#2CB500&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#2EB600&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#2FB600&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#31B700&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#33B700&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#34B800&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#36B800&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#37B900&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#39B900&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#3BBA00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#3CBA00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#3EBB00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#3FBB00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#41BC00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#43BC00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#44BD00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#46BD00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#48BE00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#49BE00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#4BBF00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#4DBF00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#4FC000&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#50C000&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#52C100&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#54C100&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#55C200&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#57C200&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#59C300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#5BC300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#5DC400&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#5EC400&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#60C500&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#62C500&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#64C600&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#66C600&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#67C700&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#69C700&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#6BC800&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#6DC800&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#6FC900&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#71C900&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#72CA00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#74CA00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#76CB00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#78CB00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#7ACC00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#7CCC00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#7ECD00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#80CD00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#82CE00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#84CE00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#86CF00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#88CF00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#8AD000&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#8BD000&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#8DD100&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#8FD100&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#91D200&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#93D200&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#95D300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#97D300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#9AD400&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#9CD400&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#9ED500&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#A0D500&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#A2D600&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#A4D600&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#A6D700&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#A8D700&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#AAD800&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ACD800&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#AED900&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#B0D900&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#B2DA00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#B5DA00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#B7DB00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#B9DB00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#BBDC00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#BDDC00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#BFDD00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#C2DD00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#C4DE00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#C6DE00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#C8DF00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#CADF00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#CDE000&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#CFE000&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#D1E100&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#D3E100&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#D6E200&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#D8E200&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#DAE300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#DCE300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#DFE400&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E1E400&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E3E500&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6E600&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6E402&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6E204&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6E105&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6DF07&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6DD09&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6DC0B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6DA0D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6D90E&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6D710&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E6D612&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7D414&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7D316&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7D217&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7D019&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7CF1B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7CE1D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7CD1F&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7CB21&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7CA22&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E7C924&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8C826&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8C728&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8C62A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8C52B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8C42D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8C32F&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8C231&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8C133&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8C035&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E8BF36&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9BE38&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9BD3A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9BC3C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9BB3E&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9BB40&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9BA42&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9B943&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9B945&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9B847&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#E9B749&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB74B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB64D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB64F&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB550&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB552&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB454&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB456&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB358&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB35A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EAB35C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB25D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB25F&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB261&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB263&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB165&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB167&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB169&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB16B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB16C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EBB16E&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB170&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB172&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB174&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB176&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB178&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB17A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB17C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB17E&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB27F&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ECB281&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB283&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB285&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB387&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB389&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB38B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB48D&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB48F&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB591&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB593&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EDB694&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEB696&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEB798&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEB89A&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEB89C&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEB99E&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEBAA0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEBAA2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEBBA4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEBCA6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EEBDA8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFBEAA&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFBEAC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFBFAD&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFC0AF&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFC1B1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFC2B3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFC3B5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFC4B7&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFC5B9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#EFC7BB&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0C8BD&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0C9BF&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0CAC1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0CBC3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0CDC5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0CEC7&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0CFC9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0D1CB&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0D2CD&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F0D3CF&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1D5D1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1D6D3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1D8D5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1D9D7&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1DBD8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1DDDA&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1DEDC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1E0DE&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1E2E0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F1E3E2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F2E5E4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F2E7E6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F2E9E8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F2EBEA&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F2ECEC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F2EEEE&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F2F0F0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#F2F2F2&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 对数据集进行训练</span>
    <span class="token keyword">let</span> variogram <span class="token operator">=</span> kriging<span class="token punctuation">.</span><span class="token function">train</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> params<span class="token punctuation">.</span>krigingModel<span class="token punctuation">,</span> params<span class="token punctuation">.</span>krigingSigma2<span class="token punctuation">,</span> params<span class="token punctuation">.</span>krigingAlpha<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将插值范围封装成特定格式</span>
    <span class="token keyword">let</span> bbox <span class="token operator">=</span> turf<span class="token punctuation">.</span><span class="token function">bbox</span><span class="token punctuation">(</span>boundaries<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 外包矩形范围</span>
    <span class="token comment">// 根据外包矩形范围生成外包矩形面Polygon</span>
    <span class="token keyword">let</span> bboxPolygon <span class="token operator">=</span> turf<span class="token punctuation">.</span><span class="token function">bboxPolygon</span><span class="token punctuation">(</span>bbox<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> positions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    bboxPolygon<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      positions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 将边界封装成特定的格式</span>
    <span class="token keyword">let</span> range <span class="token operator">=</span> <span class="token punctuation">[</span>positions<span class="token punctuation">]</span>
    <span class="token comment">// 使用variogram对象使polygons描述的地理位置内的格网元素具备不一样的预测值,最后一个参数，是插值格点精度大小</span>
    <span class="token keyword">let</span> grid <span class="token operator">=</span> kriging<span class="token punctuation">.</span><span class="token function">grid</span><span class="token punctuation">(</span>range<span class="token punctuation">,</span> variogram<span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将得到的格网grid渲染至canvas上</span>
    kriging<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> grid<span class="token punctuation">,</span> <span class="token punctuation">[</span>xlim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> xlim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>ylim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ylim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//将canvas对象转换成image的URL</span>
  <span class="token keyword">function</span> <span class="token function">returnImgae</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mycanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;canvasMap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> mycanvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 执行克里金插值函数</span>
  <span class="token function">loadkriging</span><span class="token punctuation">(</span>positionData<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> imageBounds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>ylim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> xlim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>ylim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> xlim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">imageOverlay</span><span class="token punctuation">(</span><span class="token function">returnImgae</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> imageBounds<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.8</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>imageLayerGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 生成矢量等值面并渲染</span>
<span class="token keyword">const</span> <span class="token function-variable function">showKrigingVector</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">boundaries<span class="token punctuation">,</span> positionData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 清空图层</span>
  <span class="token function">clearKriging</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 展点(可删除)</span>
  <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">geoJSON</span><span class="token punctuation">(</span>positionData<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">pointToLayer</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">feature<span class="token punctuation">,</span> latlng</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">circleMarker</span><span class="token punctuation">(</span>latlng<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fillColor</span><span class="token operator">:</span> <span class="token string">&#39;#6666ff&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fillOpacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;#fff&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">onEachFeature</span><span class="token punctuation">(</span><span class="token parameter">feature<span class="token punctuation">,</span> layer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 显示文字</span>
      <span class="token keyword">let</span> content <span class="token operator">=</span> feature<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>value
      <span class="token comment">// marker的icon文字</span>
      <span class="token keyword">let</span> myIcon <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">divIcon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">html</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;div style=&quot;white-space: nowrap;color:#6666ff;&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">iconAnchor</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token string">&#39;my-div-icon&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">iconSize</span><span class="token operator">:</span> <span class="token number">120</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> featureCenter <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">latLng</span><span class="token punctuation">(</span>feature<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> feature<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      featureLayerGroup<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">marker</span><span class="token punctuation">(</span>featureCenter<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">icon</span><span class="token operator">:</span> myIcon <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>featureLayerGroup<span class="token punctuation">)</span>
  <span class="token comment">// 颜色色带</span>
  <span class="token keyword">let</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#ffdc84&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#ffd782&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span> <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#ffd281&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#ffcd7f&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#ffc87e&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span> <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#ffc37c&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>     <span class="token punctuation">{</span> <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#ffbe7a&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#ffb979&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#feb477&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#feaf76&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#feaa74&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fea573&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fea071&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fe9b6f&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fe966e&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fe906c&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fe8b6b&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fe8669&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fe8167&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fe7c66&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fe7764&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fe7263&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fd6d61&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fd6860&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fd635e&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fd5e5c&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fd595b&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fd5459&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fd4f58&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token string">&quot;#fd4a56&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token comment">// 等级分级</span>
  <span class="token keyword">let</span> levelV <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">260</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">290</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> kriging_contours <span class="token operator">=</span> <span class="token function">getVectorContour</span><span class="token punctuation">(</span>positionData<span class="token punctuation">,</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token string">&#39;exponential&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sigma2</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">alpha</span><span class="token operator">:</span> <span class="token number">100</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> levelV<span class="token punctuation">,</span> boundaries<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 展示生成的矢量等值面</span>
  <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">geoJSON</span><span class="token punctuation">(</span>kriging_contours<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">style</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">feature</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">fillColor</span><span class="token operator">:</span> <span class="token function">hotColor</span><span class="token punctuation">(</span>feature<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fillOpacity</span><span class="token operator">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>featureLayerGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 根据值来配色</span>
  <span class="token keyword">function</span> <span class="token function">hotColor</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> levelV<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item <span class="token operator">&gt;=</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> colors<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>fill
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> colors<span class="token punctuation">[</span>colors<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fill
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 生成图像等值面并渲染</span>
<span class="token keyword">const</span> <span class="token function-variable function">showKrigingImage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">boundaries<span class="token punctuation">,</span> positionData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 清空图层</span>
  <span class="token function">clearKriging</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 完全透明</span>
  <span class="token keyword">let</span> scope <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">geoJSON</span><span class="token punctuation">(</span>boundaries<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">style</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">fillColor</span><span class="token operator">:</span> <span class="token string">&#39;6666ff&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&#39;red&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fillOpacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>imageLayerGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
  map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//根据scope边界线，生成范围信息</span>
  <span class="token keyword">let</span> xlim <span class="token operator">=</span> <span class="token punctuation">[</span>scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_southWest<span class="token punctuation">.</span>lng<span class="token punctuation">,</span> scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_northEast<span class="token punctuation">.</span>lng<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> ylim <span class="token operator">=</span> <span class="token punctuation">[</span>scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_southWest<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> scope<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_northEast<span class="token punctuation">.</span>lat<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 色带</span>
  <span class="token keyword">let</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;#006837&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#1a9850&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#66bd63&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#a6d96a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#d9ef8b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#ffffbf&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#fee08b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#fdae61&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#f46d43&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#d73027&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#a50026&quot;</span><span class="token punctuation">]</span>
  <span class="token comment">// 画布</span>
  <span class="token keyword">let</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;canvasMap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> kriging_contours <span class="token operator">=</span> <span class="token function">drawCanvasContour</span><span class="token punctuation">(</span>positionData<span class="token punctuation">,</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token string">&#39;exponential&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sigma2</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">alpha</span><span class="token operator">:</span> <span class="token number">100</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> canvas<span class="token punctuation">,</span> <span class="token punctuation">[</span>xlim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> xlim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>ylim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ylim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> colors<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//将canvas对象转换成image的URL</span>
  <span class="token keyword">function</span> <span class="token function">returnImgae</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mycanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;canvasMap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> mycanvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> imageBounds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>ylim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> xlim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>ylim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> xlim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">imageOverlay</span><span class="token punctuation">(</span><span class="token function">returnImgae</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> imageBounds<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.9</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>imageLayerGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 清空图层</span>
<span class="token keyword">const</span> <span class="token function-variable function">clearKriging</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  imageLayerGroup<span class="token punctuation">.</span><span class="token function">clearLayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  featureLayerGroup<span class="token punctuation">.</span><span class="token function">clearLayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">#myMap</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 96vw<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 96vh<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.controls</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 1000<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="leaflet-canvas-marker插件-已解决了缩放时飘的问题-增加了添加标签的功能" tabindex="-1"><a class="header-anchor" href="#leaflet-canvas-marker插件-已解决了缩放时飘的问题-增加了添加标签的功能" aria-hidden="true">#</a> leaflet-canvas-marker插件,已解决了缩放时飘的问题，增加了添加标签的功能</h3><div class="language-html" data-ext="html"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../lib/leaflet/plugins/leaflet.canvas-markers.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

       <span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token string">&#39;map&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
           <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">39.905963</span><span class="token punctuation">,</span> <span class="token number">116.390813</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
           <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
           <span class="token literal-property property">preferCanvas</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">//使用canvas模式渲染矢量图形 </span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">//添加底图</span>
       <span class="token keyword">var</span> tiles <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">tileLayer</span><span class="token punctuation">(</span><span class="token string">&#39;http://{s}.tile.osm.org/{z}/{x}/{y}.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">//使用canvas模式渲染marker</span>
       <span class="token keyword">var</span> ciLayer <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">canvasIconLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
           <span class="token keyword">var</span> lat <span class="token operator">=</span> <span class="token number">39.905963</span> <span class="token operator">+</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>
           <span class="token keyword">var</span> lng <span class="token operator">=</span> <span class="token number">116.390813</span> <span class="token operator">+</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>

           <span class="token comment">//在这里设置图片和文字，调整位置，让文字显示在图片上</span>
           <span class="token keyword">var</span> icon <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">icon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
               <span class="token literal-property property">iconUrl</span><span class="token operator">:</span> <span class="token string">&#39;./img/bg.png&#39;</span><span class="token punctuation">,</span>
               <span class="token literal-property property">iconSize</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               <span class="token literal-property property">iconAnchor</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

               <span class="token comment">//添加文字</span>
               <span class="token literal-property property">text</span><span class="token operator">:</span>i<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
               <span class="token literal-property property">textAnchor</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>         
               <span class="token literal-property property">textFont</span><span class="token operator">:</span><span class="token string">&#39;14px bold&#39;</span><span class="token punctuation">,</span>       <span class="token comment">//设置字体大小和样式</span>
               <span class="token literal-property property">textFillStyle</span><span class="token operator">:</span><span class="token string">&#39;#FFFFFF&#39;</span>     <span class="token comment">//设置字体颜色</span>
           <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

           <span class="token keyword">var</span> marker <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">marker</span><span class="token punctuation">(</span><span class="token punctuation">[</span>lat<span class="token punctuation">,</span> lng<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                   <span class="token literal-property property">icon</span><span class="token operator">:</span> icon
               <span class="token punctuation">}</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">bindPopup</span><span class="token punctuation">(</span><span class="token string">&quot;I Am &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//绑定气泡窗口</span>

           ciLayer<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>marker<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
   </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>`,11),c=[o];function e(u,l){return s(),a("div",null,c)}const i=n(p,[["render",e],["__file","kingring.html.vue"]]);export{i as default};
