import{_ as n,p as s,q as a,a1 as p}from"./framework-d81ad7e5.js";const t={},o=p(`<ul><li>如何使用<code>OpenLayers</code>在载静态图片上添加标记，预览图片。主要使用<code>ol.source.ImageStatic</code>用于显示单个静态图像的图层源。使用<code>OpenLayers</code>的好处有，地图的放大、缩小等<code>view</code>视图功能都可以使用，根据地理坐标绘制标注也能很好的使用，对于演示而言，无疑加快了开发效率。</li></ul><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code>    <span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&#39;map&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 地图设置中心</span>
    <span class="token keyword">var</span> center <span class="token operator">=</span> ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;EPSG:4326&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;EPSG:3857&#39;</span><span class="token punctuation">)</span>
    <span class="token comment">// 视图</span>
    <span class="token keyword">var</span> view <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>View</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">center</span><span class="token operator">:</span> ol<span class="token punctuation">.</span>proj<span class="token punctuation">.</span><span class="token function">fromLonLat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">7</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    map<span class="token punctuation">.</span><span class="token function">setView</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span>

    <span class="token comment">// 计算图片映射到地图上的范围，保持比例的情况下。 放大100倍 除以2 让图片中心点和地图中心点重合</span>
    <span class="token keyword">var</span> extent <span class="token operator">=</span> <span class="token punctuation">[</span>center<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">1080</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> center<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">756</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> center<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1080</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> center<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">756</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token comment">// 加载图片图层</span>
    map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>
      <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>Image</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>source<span class="token punctuation">.</span>ImageStatic</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;2.jpg&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">imageExtent</span><span class="token operator">:</span> extent <span class="token comment">//映射到地图的范围</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span> 
</code></pre></div><p>初始化<code>map</code>后这里就不需要地图图层了。</p><p>用于操作地图放大缩小的视图还是要加入<code>map</code>中，需要注意中心点要使用变量保存下来，用于定义图片图层的范围。这里中心点使用的地理坐标<code>ol.proj.fromLonLat([0, 0])</code>，并且计算图片映射范围时，使图片中心和中心点重合。不同的中心点标注计算位置时方式是不一样的。</p><p>创建图片图层加入<code>map</code>中。</p><p>绘制标注</p><ul><li>图片已经加载了，添加标注还会远吗。</li></ul><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code>js复制代码    <span class="token comment">// 创建矢量图层 绘制标注</span>
    <span class="token keyword">var</span> vLayer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>Vector</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>source<span class="token punctuation">.</span>Vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">//创建一个活动图标需要的Feature，并设置位置</span>
    <span class="token keyword">var</span> feature <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">geometry</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>geom<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span>center<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">540</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> center<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">378</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//设置Feature的样式，使用小旗帜图标</span>
    feature<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>
      <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>style<span class="token punctuation">.</span>Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">image</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">ol<span class="token punctuation">.</span>style<span class="token punctuation">.</span>Icon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token string">&#39;https://img2.baidu.com/it/u=3347068028,2336626960&amp;fm=26&amp;fmt=auto&amp;gp=0.jpg&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">anchor</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">0.2</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    vLayer<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addFeature</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span>
    map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>vLayer<span class="token punctuation">)</span>
</code></pre></div><ol><li><p>先创建<code>Vector</code>矢量图层用户加载标注。</p></li><li><p>创建点要素，要注意上面使用的<code>ol.proj.fromLonLat([0, 0])</code>，所以图片中心就是原点。计算标注位置时使用的是像素坐标，图片放大了1000倍，这里的1像素位置就是1000。最后以原点为中心的十字坐标计算标注位置就行了。</p></li><li><p>一个简单的标注操作就完成了，当然其他功能也是可以用的就和操作地图没区别，主要是坐标位置需要注意。</p></li></ol>`,9),e=[o];function c(l,u){return s(),a("div",null,e)}const r=n(t,[["render",c],["__file","static_img.html.vue"]]);export{r as default};
