import{_ as p,M as o,p as e,q as c,R as a,t as n,N as u,a1 as s}from"./framework-d81ad7e5.js";const l={},k=s(`<h2 id="leaflet-plugin" tabindex="-1"><a class="header-anchor" href="#leaflet-plugin" aria-hidden="true">#</a> leaflet plugin</h2><p>插件</p><ol><li>常用地图切换加载（osm、google、baidu、gaode、tianditu.etc）</li></ol><p>https://github.com/htoooth/Leaflet.ChineseTmsProviders</p><h3 id="切片地图加载-wmts-支持矢量切片" tabindex="-1"><a class="header-anchor" href="#切片地图加载-wmts-支持矢量切片" aria-hidden="true">#</a> 切片地图加载（wmts）（支持矢量切片）</h3><p>https://github.com/mylen/leaflet.TileLayer.WMTS</p><h3 id="wms地图服务加载" tabindex="-1"><a class="header-anchor" href="#wms地图服务加载" aria-hidden="true">#</a> wms地图服务加载</h3><p>https://github.com/heigeo/leaflet.wms</p><h3 id="视窗范围框定-只容许查看和编辑给定范围地图" tabindex="-1"><a class="header-anchor" href="#视窗范围框定-只容许查看和编辑给定范围地图" aria-hidden="true">#</a> 视窗范围框定（只容许查看和编辑给定范围地图）</h3><p>https://github.com/aparshin/leaflet-boundary-canvas</p><h3 id="地图要素显示比例尺控制-不同比例尺要素渲染-根据屏幕坐标控制-非常重要-常用" tabindex="-1"><a class="header-anchor" href="#地图要素显示比例尺控制-不同比例尺要素渲染-根据屏幕坐标控制-非常重要-常用" aria-hidden="true">#</a> 地图要素显示比例尺控制（不同比例尺要素渲染）（根据屏幕坐标控制）（非常重要，常用）</h3><p>https://github.com/GreenInfo-Network/L.TileLayer.PixelFilter/</p><h3 id="卷帘对比-卷积运算-历史对比-非常重要" tabindex="-1"><a class="header-anchor" href="#卷帘对比-卷积运算-历史对比-非常重要" aria-hidden="true">#</a> 卷帘对比（卷积运算）（历史对比）（非常重要）</h3><p>https://github.com/digidem/leaflet-side-by-side</p><h3 id="webgl地图要素渲染-适用于三维要素绘制-非常重要" tabindex="-1"><a class="header-anchor" href="#webgl地图要素渲染-适用于三维要素绘制-非常重要" aria-hidden="true">#</a> webGL地图要素渲染（适用于三维要素绘制）（非常重要）</h3><p>https://gitlab.com/IvanSanchez/Leaflet.TileLayer.GL</p><h3 id="快速重新渲染地图要素-动态修改地图样式-适用于矢量切片-不用二次发布服务-很实用" tabindex="-1"><a class="header-anchor" href="#快速重新渲染地图要素-动态修改地图样式-适用于矢量切片-不用二次发布服务-很实用" aria-hidden="true">#</a> 快速重新渲染地图要素，动态修改地图样式（适用于矢量切片）(不用二次发布服务)（很实用）</h3><p>（颜色获取） https://github.com/frogcat/leaflet-tilelayer-colorpicker</p><p>（样式调整）https://github.com/hnrchrdl/leaflet-tilelayer-colorizr</p><h3 id="快速获取要素范围和属性信息-tootip方式" tabindex="-1"><a class="header-anchor" href="#快速获取要素范围和属性信息-tootip方式" aria-hidden="true">#</a> 快速获取要素范围和属性信息（tootip方式）</h3><p>https://github.com/consbio/Leaflet.UTFGrid</p><h3 id="缓冲区-不推荐-存在bug-推荐使用geotools-api后台生成缓冲区-需要坐标转换" tabindex="-1"><a class="header-anchor" href="#缓冲区-不推荐-存在bug-推荐使用geotools-api后台生成缓冲区-需要坐标转换" aria-hidden="true">#</a> 缓冲区（不推荐，存在bug，推荐使用geotools api后台生成缓冲区，需要坐标转换）</h3><p>https://github.com/TolonUK/Leaflet.EdgeBuffer https://github.com/skeate/Leaflet.buffer</p><h3 id="要素图层组加载过程数据获取-支持featuregroup-loading和load事件" tabindex="-1"><a class="header-anchor" href="#要素图层组加载过程数据获取-支持featuregroup-loading和load事件" aria-hidden="true">#</a> 要素图层组加载过程数据获取（支持FeatureGroup loading和load事件）</h3><p>https://github.com/Outdooractive/Leaflet.FeatureGroup.LoadEvents</p><h3 id="地图要素移除-动态重新渲染底图-动画效果-缓冲效果" tabindex="-1"><a class="header-anchor" href="#地图要素移除-动态重新渲染底图-动画效果-缓冲效果" aria-hidden="true">#</a> 地图要素移除，动态重新渲染底图（动画效果，缓冲效果）</h3><p>https://gitlab.com/IvanSanchez/Leaflet.GridLayer.FadeOut</p><h3 id="地图矢量切片服务加载和渲染-非常重要" tabindex="-1"><a class="header-anchor" href="#地图矢量切片服务加载和渲染-非常重要" aria-hidden="true">#</a> 地图矢量切片服务加载和渲染（非常重要）</h3><p>https://github.com/Leaflet/Leaflet.VectorGrid</p><p>（mapbox切片渲染）https://github.com/SpatialServer/Leaflet.MapboxVectorTile</p><p>（geojson格式渲染）https://github.com/mapbox/geojson-vt</p><h3 id="常用格式地理数据加载-wkt、geojson、kml、gpx、csv、mdb、shp等" tabindex="-1"><a class="header-anchor" href="#常用格式地理数据加载-wkt、geojson、kml、gpx、csv、mdb、shp等" aria-hidden="true">#</a> 常用格式地理数据加载（WKT、GeoJSON、KML、GPX、CSV、MDB、Shp等）</h3><p>https://github.com/mapbox/leaflet-omnivore</p><p>https://github.com/makinacorpus/Leaflet.FileLayer</p><p>https://github.com/calvinmetcalf/leaflet.shapefile</p><h3 id="地图wfs服务操作" tabindex="-1"><a class="header-anchor" href="#地图wfs服务操作" aria-hidden="true">#</a> 地图WFS服务操作，</h3><ul><li>数据增删改查（Inert、Update、Delete、Query、Transaction）（重中之重，WFS服务封装，结合oracle或者postgis数据库，arcgis server或者geoserver后台服务搭建）</li></ul><p>https://github.com/Flexberry/Leaflet-WFST</p><p>存在bug，需要修改，已在github issues中为作者留言，希望尽快解决；</p><p>如果geoserver搭建服务端：</p><p>typeNS表示工作区间， typeName表示图层名称（表名一致）</p><h3 id="自定义label标签-marker-polygon" tabindex="-1"><a class="header-anchor" href="#自定义label标签-marker-polygon" aria-hidden="true">#</a> 自定义label标签（Marker，polygon）</h3><p>https://github.com/Leaflet/Leaflet.label</p><h3 id="自定义marker" tabindex="-1"><a class="header-anchor" href="#自定义marker" aria-hidden="true">#</a> 自定义marker</h3><p>https://github.com/marslan390/BeautifyMarker</p><h3 id="聚合数据" tabindex="-1"><a class="header-anchor" href="#聚合数据" aria-hidden="true">#</a> 聚合数据</h3><p>https://github.com/Leaflet/Leaflet.markercluster</p><p>https://github.com/MazeMap/Leaflet.LayerGroup.Collision</p><p>https://github.com/SINTEF-9012/PruneCluster</p><h3 id="热力图" tabindex="-1"><a class="header-anchor" href="#热力图" aria-hidden="true">#</a> 热力图</h3><p>https://github.com/Leaflet/Leaflet.heat</p><p>http://ursudio.com/webgl-heatmap-leaflet/</p><h3 id="加载echarts图-聚合图、迁徙图、热力图-非常实用" tabindex="-1"><a class="header-anchor" href="#加载echarts图-聚合图、迁徙图、热力图-非常实用" aria-hidden="true">#</a> 加载echarts图（聚合图、迁徙图、热力图）（非常实用）</h3><p>https://github.com/wandergis/leaflet-echarts.git</p><h3 id="要素编辑-面合并、分割、创建要素等-结合leaflet-wfst-非常实用" tabindex="-1"><a class="header-anchor" href="#要素编辑-面合并、分割、创建要素等-结合leaflet-wfst-非常实用" aria-hidden="true">#</a> 要素编辑（面合并、分割、创建要素等）（结合leaflet.wfst）(非常实用)</h3><p>https://github.com/Leaflet/Leaflet.toolbar</p><p>https://github.com/Leaflet/Leaflet.draw</p><p>https://github.com/Leaflet/Leaflet.Editable</p><p>https://github.com/codeofsumit/leaflet.pm</p><p>https://github.com/willfarrell/Leaflet.Clipper</p><h3 id="图层切换-要素显示隐藏" tabindex="-1"><a class="header-anchor" href="#图层切换-要素显示隐藏" aria-hidden="true">#</a> 图层切换，要素显示隐藏</h3><p>https://github.com/ismyrnow/leaflet-groupedlayercontrol</p><h3 id="地图导航条、全屏控件" tabindex="-1"><a class="header-anchor" href="#地图导航条、全屏控件" aria-hidden="true">#</a> 地图导航条、全屏控件</h3><p>https://github.com/turbo87/sidebar-v2/</p><p>https://github.com/kartena/Leaflet.Pancontrol</p><p>https://github.com/kartena/Leaflet.zoomslider</p><p>https://github.com/Leaflet/Leaflet.fullscreen</p><p>https://github.com/brunob/leaflet.fullscreen</p><h3 id="鹰眼图" tabindex="-1"><a class="header-anchor" href="#鹰眼图" aria-hidden="true">#</a> 鹰眼图</h3><p>https://github.com/Norkart/Leaflet-MiniMap</p><h3 id="测量控件" tabindex="-1"><a class="header-anchor" href="#测量控件" aria-hidden="true">#</a> 测量控件</h3><p>https://github.com/ljagis/leaflet-measure</p><h3 id="控件按钮样式设置" tabindex="-1"><a class="header-anchor" href="#控件按钮样式设置" aria-hidden="true">#</a> 控件按钮样式设置</h3><p>https://github.com/CliffCloud/Leaflet.EasyButton</p><p>https://github.com/aratcliffe/Leaflet.contextmenu</p><h3 id="地图打印插件" tabindex="-1"><a class="header-anchor" href="#地图打印插件" aria-hidden="true">#</a> 地图打印插件</h3><p>https://github.com/rowanwins/leaflet-easyPrint</p><p>https://github.com/Igor-Vladyka/leaflet.browser.print</p><h3 id="定位当前位置" tabindex="-1"><a class="header-anchor" href="#定位当前位置" aria-hidden="true">#</a> 定位当前位置</h3><p>https://github.com/domoritz/leaflet-locatecontrol</p><h3 id="坐标转换插件-与缓冲区、测量配合使用-非常实用" tabindex="-1"><a class="header-anchor" href="#坐标转换插件-与缓冲区、测量配合使用-非常实用" aria-hidden="true">#</a> 坐标转换插件（与缓冲区、测量配合使用）（非常实用）</h3><p>https://github.com/kartena/Proj4Leaflet</p><h3 id="空间位置分析-非常实用" tabindex="-1"><a class="header-anchor" href="#空间位置分析-非常实用" aria-hidden="true">#</a> 空间位置分析（非常实用）</h3><p>（点是否在面内）https://github.com/kartena/Proj4Leaflet</p><p>（计算面积、距离）https://github.com/makinacorpus/Leaflet.GeometryUtil/blob/master/src/leaflet.geometryutil.js</p><h3 id="路径分析-纠偏-地图匹配算法" tabindex="-1"><a class="header-anchor" href="#路径分析-纠偏-地图匹配算法" aria-hidden="true">#</a> 路径分析（纠偏，地图匹配算法）</h3><p>https://github.com/perliedman/leaflet-routing-machine</p><p>https://github.com/Project-OSRM/osrm-frontend</p><h3 id="poi模糊查询" tabindex="-1"><a class="header-anchor" href="#poi模糊查询" aria-hidden="true">#</a> poi模糊查询</h3><p>https://github.com/smeijer/leaflet-geosearch</p><p>https://github.com/perliedman/leaflet-control-geocoder</p><h3 id="等势线、等势面" tabindex="-1"><a class="header-anchor" href="#等势线、等势面" aria-hidden="true">#</a> 等势线、等势面</h3><p>https://github.com/timwis/leaflet-choropleth</p><h3 id="leaflet-pm插件" tabindex="-1"><a class="header-anchor" href="#leaflet-pm插件" aria-hidden="true">#</a> Leaflet.pm插件</h3><p>用于创建和编辑几何图层的插件</p><p>可绘制、编辑、拖动、剪切和捕捉图层</p><p>支持标记、CircleMarkers、折线、多边形、圆形、矩形、LayerGroups、GeoJSON 和 MultiPolygons</p><div class="language-vue" data-ext="vue"><pre class="language-vue"><code>​
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>map<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>map<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token string">&quot;leaflet/dist/leaflet.css&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token constant">L</span> <span class="token keyword">from</span> <span class="token string">&quot;leaflet&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;leaflet.pm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;leaflet.pm/dist/leaflet.pm.css&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;leafletPm&quot;</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">map</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">OSMUrl</span><span class="token operator">:</span> <span class="token string">&quot;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">initMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token string">&quot;map&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">setView</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">34.03</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">118.15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> tileLayer <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">tileLayer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>OSMUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
      tileLayer<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 添加绘制工具</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span>pm<span class="token punctuation">.</span><span class="token function">setLang</span><span class="token punctuation">(</span><span class="token string">&quot;zh&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span>pm<span class="token punctuation">.</span><span class="token function">addControls</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">&quot;topleft&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">drawPolygon</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//绘制多边形</span>
        <span class="token literal-property property">drawMarker</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//绘制标记点</span>
        <span class="token literal-property property">drawCircleMarker</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//绘制圆形标记</span>
        <span class="token literal-property property">drawPolyline</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//绘制线条</span>
        <span class="token literal-property property">drawRectangle</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//绘制矩形</span>
        <span class="token literal-property property">drawCircle</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//绘制圆圈</span>
        <span class="token literal-property property">editMode</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//编辑多边形</span>
        <span class="token literal-property property">dragMode</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//拖动多边形</span>
        <span class="token literal-property property">cutPolygon</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//添加⼀个按钮以删除多边形⾥⾯的部分内容</span>
        <span class="token literal-property property">removalMode</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//清除多边形</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 全局设置绘制样式</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span>pm<span class="token punctuation">.</span><span class="token function">setPathOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;orange&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fillColor</span><span class="token operator">:</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fillOpacity</span><span class="token operator">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 或者单独设置绘制样式</span>
      <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token comment">// 连接线标记之间的线</span>
        <span class="token literal-property property">templineStyle</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 提⽰线从最后⼀个标记到⿏标光标的线</span>
        <span class="token literal-property property">hintlineStyle</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">dashArray</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 绘制完成的样式</span>
        <span class="token literal-property property">pathOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;orange&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">fillColor</span><span class="token operator">:</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 激活绘制多边形功能-1、单独设置某个模式的样式</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span>pm<span class="token punctuation">.</span><span class="token function">enableDraw</span><span class="token punctuation">(</span><span class="token string">&quot;Polygon&quot;</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 启用绘制--多边形功能</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span>pm<span class="token punctuation">.</span><span class="token function">enableDraw</span><span class="token punctuation">(</span><span class="token string">&quot;Polygon&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">snappable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//启⽤捕捉到其他绘制图形的顶点</span>
        <span class="token literal-property property">snapDistance</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">//顶点捕捉距离</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 关闭绘制--注意也可以关闭其他模式的绘制功能</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span>pm<span class="token punctuation">.</span><span class="token function">disableDraw</span><span class="token punctuation">(</span><span class="token string">&quot;Polygon&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 绘制事件监听</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;pm:drawstart&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">&quot;绘制开始第一个点&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;pm:drawend&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">&quot;禁⽌绘制、绘制结束&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;pm:create&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">&quot;绘制完成时调⽤&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>shape <span class="token operator">==</span> <span class="token string">&quot;Circle&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>_latlng<span class="token punctuation">,</span> e<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>_radius<span class="token punctuation">,</span> <span class="token string">&quot;绘制坐标&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>layer<span class="token punctuation">.</span>_latlngs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;绘制坐标&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;pm:globalremovalmodetoggled&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">&quot;清除图层时调用&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span> 
</code></pre></div><h3 id="https-turfjs-fenxianglu-cn" tabindex="-1"><a class="header-anchor" href="#https-turfjs-fenxianglu-cn" aria-hidden="true">#</a> https://turfjs.fenxianglu.cn/</h3><h3 id="leaflet的轨迹模拟回放-animatedmarker" tabindex="-1"><a class="header-anchor" href="#leaflet的轨迹模拟回放-animatedmarker" aria-hidden="true">#</a> Leaflet的轨迹模拟回放 animatedmarker</h3><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code>npm i <span class="token operator">-</span>save leaflet<span class="token punctuation">.</span>animatedmarker

<span class="token comment">// 在页面引入</span>
<span class="token keyword">import</span> <span class="token string">&#39;leaflet.animatedmarker/src/AnimatedMarker&#39;</span><span class="token punctuation">;</span>


  <span class="token doc-comment comment">/**
   * PolyLine
   */</span>
  <span class="token keyword">var</span> latlngs <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">39.89571049162436</span><span class="token punctuation">,</span> <span class="token number">116.28887714936559</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.89574033334674</span><span class="token punctuation">,</span> <span class="token number">116.30303539096508</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.89696383279323</span><span class="token punctuation">,</span> <span class="token number">116.30326876857339</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.89696383279323</span><span class="token punctuation">,</span> <span class="token number">116.30428007154455</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.904930965629774</span><span class="token punctuation">,</span> <span class="token number">116.30431896781283</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.905080154037904</span><span class="token punctuation">,</span> <span class="token number">116.30599150734332</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.90591560311958</span><span class="token punctuation">,</span> <span class="token number">116.30653605509644</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.906184091768495</span><span class="token punctuation">,</span> <span class="token number">116.31839941532661</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.90624376607943</span><span class="token punctuation">,</span> <span class="token number">116.32345593018351</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.906184091768495</span><span class="token punctuation">,</span> <span class="token number">116.3293292666715</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.90586571685398</span><span class="token punctuation">,</span> <span class="token number">116.33772942258247</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.905716530156496</span><span class="token punctuation">,</span> <span class="token number">116.34900934033908</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.90595522871635</span><span class="token punctuation">,</span> <span class="token number">116.35033181345642</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.90881804431149</span><span class="token punctuation">,</span> <span class="token number">116.3502732434797</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.91388998013704</span><span class="token punctuation">,</span> <span class="token number">116.3504288285514</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.91761910511673</span><span class="token punctuation">,</span> <span class="token number">116.35031213974798</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.92012496302843</span><span class="token punctuation">,</span> <span class="token number">116.3502732434797</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.922392088792634</span><span class="token punctuation">,</span> <span class="token number">116.3500009696017</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.922213107908675</span><span class="token punctuation">,</span> <span class="token number">116.34568348384079</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.92203412655681</span><span class="token punctuation">,</span> <span class="token number">116.34012131749762</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.92198349105365</span><span class="token punctuation">,</span> <span class="token number">116.33823159519835</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.92484713865562</span><span class="token punctuation">,</span> <span class="token number">116.33788152878526</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">39.92487696768799</span><span class="token punctuation">,</span> <span class="token number">116.33967075711911</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> polyline <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">polyline</span><span class="token punctuation">(</span>latlngs<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map_dom<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 轨迹回放</span>
  <span class="token keyword">let</span> animatedMarker <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">animatedMarker</span><span class="token punctuation">(</span>latlngs<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> hospitalCarIcon<span class="token punctuation">,</span> <span class="token literal-property property">autoStart</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">interval</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    <span class="token function-variable function">onEnd</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 结束</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map_dom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  map_dom<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>latlngs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setZoom</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    animatedMarker<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="sidebar" tabindex="-1"><a class="header-anchor" href="#sidebar" aria-hidden="true">#</a> sidebar</h3><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code>
<span class="token keyword">import</span> <span class="token string">&quot;@/utils/sidebar/leaflet-sidebar.css&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;@/utils/sidebar/leaflet-sidebar.js&quot;</span><span class="token punctuation">;</span>


  <span class="token keyword">var</span> sidebar <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>control<span class="token punctuation">.</span><span class="token function">sidebar</span><span class="token punctuation">(</span><span class="token string">&quot;sidebar&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">&quot;left&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sidebar<span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map_dom<span class="token punctuation">)</span>
  <span class="token comment">// map_dom.addControl(sidebar);</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sidebar<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><div class="language-html" data-ext="html"><pre class="language-html"><code>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar collapsed<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- Nav tabs --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-tabs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tablist<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#home<span class="token punctuation">&quot;</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tab<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xz_info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ooxx <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#profile<span class="token punctuation">&quot;</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tab<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>aacc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span>  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#messages<span class="token punctuation">&quot;</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tab<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>vva<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://github.com/Turbo87/sidebar-v2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tab<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_blank<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>aacc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tablist<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#settings<span class="token punctuation">&quot;</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tab<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-gear<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
 
        <span class="token comment">&lt;!-- Tab panes --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-pane<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>home<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    sidebar-v2
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-close<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-caret-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
 
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>A responsive sidebar for mapping libraries like <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://leafletjs.com/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Leaflet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span> or <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://openlayers.org/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>OpenLayers<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
 
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lorem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Lo t.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
 
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lorem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>L met.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
 
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lorem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Lor met.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-pane<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>profile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Profile<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-close<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-caret-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-pane<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>messages<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Messages<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-close<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-caret-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-pane<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>settings<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Settings<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sidebar-close<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-caret-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> 
</code></pre></div><h3 id="扩展工具栏指南" tabindex="-1"><a class="header-anchor" href="#扩展工具栏指南" aria-hidden="true">#</a> 扩展工具栏指南</h3><p>第一、自己基于dom创建页面元素，并挂载在其默认的工具栏中。</p><p>第二、基于Leaflet.EasyButton进行扩展。</p><p>其实，围绕着LeafLet，有许多实用的插件，比如工具栏扩展组件，大家可以针对自己的业务进行选取使用。本文将介绍如何基于Leaflet.EasyButton进行扩展。</p><p>第一步：在github上下载相关资源，插件地址：https://github.com/CliffCloud/Leaflet.EasyButton。</p><p>第二步、引入easyButton相关资源</p><div class="language-html" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/2d/css/font-awesome.min.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/2d/Leaflet.EasyButton/src/easy-button.css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/2d/leaflet/leaflet.js?v=1.0.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/2d/Leaflet.EasyButton/src/easy-button.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>第三步、定义button对象</p><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">easyButton</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;span class=&#39;fa fa-globe &#39; style=&#39;font-size:18px;height:30px;line-height:30px;&#39;&gt;&lt;/span&gt;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">btn<span class="token punctuation">,</span> map</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			helloPopup<span class="token punctuation">.</span><span class="token function">setLatLng</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getCenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openOn</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>mymap<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
 
<span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">easyButton</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;span class=&#39;fa fa-star &#39; style=&#39;font-size:18px;height:30px;line-height:30px;&#39;&gt;&lt;/span&gt;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">btn<span class="token punctuation">,</span> map</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment">//helloPopup.setLatLng(map.getCenter()).openOn(map);</span>
			layer<span class="token punctuation">.</span><span class="token function">msg</span><span class="token punctuation">(</span><span class="token string">&quot;我被点击了&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>mymap<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><h3 id="leaflet的多点聚合展示markercluster" tabindex="-1"><a class="header-anchor" href="#leaflet的多点聚合展示markercluster" aria-hidden="true">#</a> LeafLet的多点聚合展示markercluster</h3><ul><li>批量操作存放在layerGroup中的所有元素</li><li>var cities = L.layerGroup();</li><li>L.marker([36.606445, 109.522705],{icon:flagIcon,title:&#39;延安分公司&#39;}).bindPopup(&#39;延安分公司&#39;).addTo(cities); 将layerGroup添加到地图上​​​​​​​</li></ul><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> overlays <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;分公司&quot;</span><span class="token operator">:</span> cities
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token constant">L</span><span class="token punctuation">.</span>control<span class="token punctuation">.</span><span class="token function">layers</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>overlays<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>mymap<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="leaflet的轨迹模拟回放-movingmarker-js-插件" tabindex="-1"><a class="header-anchor" href="#leaflet的轨迹模拟回放-movingmarker-js-插件" aria-hidden="true">#</a> Leaflet的轨迹模拟回放 MovingMarker.js 插件</h3><ul><li>https://github.com/ewoken/Leaflet.MovingMarker</li><li><code>npm i Leaflet-MovingMaker</code></li></ul><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token punctuation">{</span> 
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 唯一标识, 后期删除轨迹要用</span>
    <span class="token literal-property property">iconUrl</span><span class="token operator">:</span> <span class="token string">&#39;https:******.png&#39;</span><span class="token punctuation">,</span>  <span class="token comment">// iconUrl</span>
    <span class="token literal-property property">speed</span><span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span> <span class="token comment">// 速度</span>
    <span class="token literal-property property">latlngs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>lat1，lng2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>lat2，lng2<span class="token punctuation">]</span><span class="token punctuation">,</span> …<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">html</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;div&gt; .... &lt;/div&gt;</span><span class="token template-punctuation string">\`</span></span>  <span class="token comment">// 标牌, 样式自理</span>
<span class="token punctuation">}</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleCreateTrack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token function">handleCreateTrack</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 
      <span class="token keyword">let</span> featureGroup <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 轨迹线</span>
      <span class="token keyword">let</span> routeLine <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">polyline</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>latlngs<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token comment">// 定义线的透明度</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 定位该线至可视窗口</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>routeLine<span class="token punctuation">.</span><span class="token function">getBounds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 创建icon</span>
      <span class="token keyword">let</span> carIcon <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">icon</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">iconSize</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">iconUrl</span><span class="token operator">:</span> config<span class="token punctuation">.</span>iconUrl<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 动态marker</span>
      <span class="token keyword">let</span> animatedMarker <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>Marker<span class="token punctuation">.</span><span class="token function">movingMarker</span><span class="token punctuation">(</span>
        routeLine<span class="token punctuation">.</span><span class="token function">getLatLngs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        config<span class="token punctuation">.</span>speed<span class="token punctuation">,</span> 
      <span class="token comment">// 以下配置项在github上有详细注解-----</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">autostart</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token literal-property property">loop</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token literal-property property">icon</span><span class="token operator">:</span> carIcon<span class="token punctuation">,</span>
          <span class="token literal-property property">rotate</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bindPopup</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 移动结束时弹出标牌</span>
      animatedMarker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;end&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        animatedMarker<span class="token punctuation">.</span><span class="token function">openPopup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token comment">// 记录划线过程</span>
      <span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      animatedMarker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;move&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 回调中会返回经纬度信息，点移动改变地图中心点</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">panTo</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">.</span>latlng<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> res<span class="token punctuation">.</span>latlng<span class="token punctuation">.</span>lng<span class="token punctuation">]</span><span class="token punctuation">)</span> 
        <span class="token comment">// 动态画已走路线</span>
        <span class="token keyword">let</span> polyline <span class="token operator">=</span> <span class="token operator">...</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
      featureGroup<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>animatedMarker<span class="token punctuation">)</span><span class="token punctuation">;</span>
      featureGroup<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>routeLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token keyword">let</span> featureGroup <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">featureGroup</span><span class="token punctuation">(</span>featureGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      <span class="token comment">// 记录地图上的点、线、面 ... 根据id 可动态删除</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>clusterLayer<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> config<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> featureGroup<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>featureGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>




<span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>这里是我们的点位数据<span class="token punctuation">)</span> <span class="token comment">// 将地图视层尽可能大的设定在给定的地理边界内</span>
<span class="token keyword">var</span> marker2 <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>Marker<span class="token punctuation">.</span><span class="token function">movingMarker</span><span class="token punctuation">(</span>点位数据格式与marker内的一样<span class="token punctuation">[</span>lat<span class="token punctuation">,</span>lng<span class="token punctuation">]</span><span class="token punctuation">,</span> 
<span class="token number">10000</span> <span class="token string">&#39;//动画时长&#39;</span> <span class="token punctuation">,</span> 
<span class="token punctuation">{</span> <span class="token literal-property property">autostart</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">loop</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">icon</span><span class="token operator">:</span> policeCarIcon<span class="token punctuation">,</span> <span class="token literal-property property">rotate</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">)</span>
<span class="token comment">//后面这些可以参考上面的插件文档进行解读</span>
<span class="token comment">// 地图根据点位移动，一直设置点位为中心点</span>
<span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 声明绘制线的临时使用变量</span>
marker2<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;move&#39;</span><span class="token punctuation">,</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 监听点位移动事件 move</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">panTo</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">.</span>latlng<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> res<span class="token punctuation">.</span>latlng<span class="token punctuation">.</span>lng<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//回调中会返回经纬度信息，点移动改变地图中心点</span>
    path<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> path<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 保持数组长度，避免过度push不断重新绘制之前的路径</span>
    path<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res<span class="token punctuation">.</span>latlng<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> res<span class="token punctuation">.</span>latlng<span class="token punctuation">.</span>lng<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 将数据push到数组中</span>
    <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">polyline</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&#39;#20a080&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">)</span> <span class="token comment">// 绘制线到地图图层</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 这里我做了一个轨迹回放结束事件 end</span>
marker2<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// closeOnClick: false 点击别处不会消失</span>
    marker2<span class="token punctuation">.</span><span class="token function">bindPopup</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;b&gt;轨迹结束显示&lt;/b&gt;&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">closeOnClick</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openPopup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//-------------------------------------------------------------------------------------------------------------- </span>

  <span class="token doc-comment comment">/**
   *
   */</span>
  <span class="token keyword">var</span> parisKievLL <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">28.8567</span><span class="token punctuation">,</span> <span class="token number">112.3508</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">30.45</span><span class="token punctuation">,</span> <span class="token number">130.523333</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> londonParisRomeBerlinBucarest <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">31.507222</span><span class="token punctuation">,</span> <span class="token number">110.1275</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">28.8567</span><span class="token punctuation">,</span> <span class="token number">112.3508</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">31.9</span><span class="token punctuation">,</span> <span class="token number">112.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">31.516667</span><span class="token punctuation">,</span> <span class="token number">113.383333</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">31.4166</span><span class="token punctuation">,</span> <span class="token number">126.1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
 
  map_dom<span class="token punctuation">.</span><span class="token function">fitBounds</span><span class="token punctuation">(</span>londonParisRomeBerlinBucarest<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> marker1 <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>Marker<span class="token punctuation">.</span><span class="token function">movingMarker</span><span class="token punctuation">(</span>parisKievLL<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map_dom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">polyline</span><span class="token punctuation">(</span>parisKievLL<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map_dom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  marker1<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    marker1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    marker1<span class="token punctuation">.</span><span class="token function">closePopup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    marker1<span class="token punctuation">.</span><span class="token function">unbindPopup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    marker1<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>marker1<span class="token punctuation">.</span><span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        marker1<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        marker1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      marker1<span class="token punctuation">.</span><span class="token function">bindPopup</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;b&gt;点我暂停 !&lt;/b&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openPopup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  marker1<span class="token punctuation">.</span><span class="token function">bindPopup</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;b&gt;点我开始!&lt;/b&gt;&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">closeOnClick</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  marker1<span class="token punctuation">.</span><span class="token function">openPopup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> myMovingMarker <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>Marker<span class="token punctuation">.</span><span class="token function">movingMarker</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">48.8567</span><span class="token punctuation">,</span> <span class="token number">2.3508</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">50.45</span><span class="token punctuation">,</span> <span class="token number">30.523333</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
						<span class="token punctuation">[</span><span class="token number">20000</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTo</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//...</span>
myMovingMarker<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="api" tabindex="-1"><a class="header-anchor" href="#api" aria-hidden="true">#</a> API</h2><p><strong>Factory</strong></p><div class="language-text" data-ext="text"><pre class="language-text"><code>L.movingMarker(&lt;LatLng[]&gt; latlngs, &lt;Number[]&gt; durations [,&lt;Object&gt; options]);
</code></pre></div><p><strong>durations</strong>:</p><ul><li>if array of number : duration in ms per line segment.</li><li>if number : total duration (autocalculate duration in ms per line segment proportionnaly to distance between points).</li></ul>`,125),i={href:"http://leafletjs.com/reference.html#latlng",target:"_blank",rel:"noopener noreferrer"},r=s("<p><strong>Options</strong> All the marker&#39;s options are available.</p><ul><li><code>autostart</code>: if <code> true</code> the marker will start automatically after it is added to map. Default: <code>false</code></li><li><code> loop</code>: if <code>true</code> the marker will start automatically at the beginning of the polyline when the it arrives at the end. Default: <code>false</code></li></ul><p><strong>Methods</strong></p><p><em>Getter</em></p><ul><li><p><code> isRunning()</code>: return <code>true</code> if the marker is currently moving.</p></li><li><p><code>isPaused()</code>: return <code>true</code> if the marker is paused</p></li><li><p><code> isEnded()</code>: return <code>true</code> if the marker is arrived to the last position or it has been stopped manually</p></li><li><p><code>isStarted()</code>: return <code>true</code> if the marker has started</p></li></ul><p><strong>Note</strong>: <code>Marker.getLatLng()</code> still works and give the current position</p><p><em>Setter</em></p><ul><li><code>start()</code>: the marker begins its path or resumes if it is paused.</li><li><code> stop()</code>: manually stops the marker, if you call ```start`` after, the marker starts again the polyline at the beginning.</li><li><code>pause()</code>: just pauses the marker</li><li><code> resume()</code>: the marker resumes its animation</li><li><code>addLatLng(latlng, duration)</code>: adds a point to the polyline. Useful, if we have to set the path one by one.</li><li><code> moveTo(latlng, duration)</code>: stops current animation and make the marker move to <code>latlng</code> in <code>duration</code> ms.</li><li><code>addStation(pointIndex, duration)</code>: the marker will stop at the <code>pointIndex</code>th points of the polyline during <code>duration</code> ms. You can&#39;t add a station at the first or last point of the polyline.</li></ul><p><em>Events</em></p><ul><li><code>start</code>: fired when the marker starts</li><li><code> end</code>: fired when the marker stops</li><li><code>loop</code>: fired when the marker begin a new loop</li></ul>",10);function d(g,m){const t=o("ExternalLinkIcon");return e(),c("div",null,[k,a("p",null,[n("Note: As Leaftlet's other functions, it also accept them in a simple Array form and simple object form ("),a("a",i,[n("see Leaflet docs"),u(t)]),n(").")]),r])}const f=p(l,[["render",d],["__file","leaflet_d_plugin.html.vue"]]);export{f as default};
